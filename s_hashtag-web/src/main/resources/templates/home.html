<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html>
<head>
    <meta charset="UTF-8">
<!--    <link href="../css/bootstrap.min.css" rel="stylesheet">-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<!--    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer" />-->

    <!-- CSS -->
<!--    <link href="css/styles.css" rel="stylesheet" >-->

    <!-- IONICONS -->
    <script src="https://unpkg.com/ionicons@5.2.3/dist/ionicons.js"></script>
    <!-- JS -->
<!--    <script src="js/main.js"></script>-->

    <title>s_tag</title>

</head>

<body id="body-pd">
<div class="l-navbar" id="navbar">
    <nav class="nav">
        <div>
            <div class="nav__brand">
                <ion-icon name="menu-outline" class="nav__toggle" id="nav-toggle"></ion-icon>
                <a href="#" class="nav__logo"></a>
            </div>
            <div class="nav__list">
                <a href="/members/kakao" class="nav__link active">
                    <ion-icon name="home-outline" class="nav__icon"></ion-icon>
                    <span class="nav_name">Dashboard</span>
                </a>
                <a href="#" class="nav__link">
                    <ion-icon name="chatbubbles-outline" class="nav__icon"></ion-icon>
                    <span class="nav_name">Messenger</span>
                </a>

                <div href="#" class="nav__link collapse">
                    <ion-icon name="folder-outline" class="nav__icon"></ion-icon>
                    <span class="nav_name">Projects</span>

                    <ion-icon name="chevron-down-outline" class="collapse__link"></ion-icon>

                    <ul class="collapse__menu">
                        <a href="#" class="collapse__sublink">Data</a>
                        <a href="#" class="collapse__sublink">Group</a>
                        <a href="#" class="collapse__sublink">Members</a>
                    </ul>
                </div>
                <a href="#" onclick="kakaoMap();" class="nav__link">
                    <ion-icon name="pie-chart-outline" class="nav__icon"></ion-icon>
                    <span class="nav_name">Analytics</span>
                </a>

                <div href="#" onclick="create_marker_test();" class="nav__link collapse">
                    <ion-icon name="people-outline" class="nav__icon"></ion-icon>
                    <span class="nav_name">Team</span>

                    <ion-icon name="chevron-down-outline" class="collapse__link"></ion-icon>

                    <ul class="collapse__menu">
                        <a href="#" class="collapse__sublink">Data</a>
                        <a href="#" class="collapse__sublink">Group</a>
                        <a href="#" class="collapse__sublink">Members</a>
                    </ul>
                </div>

                <a href="#" class="nav__link">
                    <ion-icon name="settings-outline" class="nav__icon"></ion-icon>
                    <span class="nav_name">Settings</span>
                </a>
            </div>
            <a href="/members/add" class="nav__link">
                <ion-icon name="person-add-outline" class="nav__icon"></ion-icon>
                <span class="nav_name">Sign-up</span>
            </a>
            <a href="/login" class="nav__link">
                <ion-icon name="log-in-outline" class="nav__icon"></ion-icon>
                <span class="nav_name">Log in</span>
            </a>
        </div>
    </nav>
</div>
<p id="result"></p>
<p id="result2"></p>
<p id="result3"></p>
<div id="map" style="width:99%;height:600px;"></div>

</body>

<!-- services 라이브러리 불러오기 -->
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=e3911e7fa46ab16ff0c8b85eb101877e&libraries=services"></script>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=e3911e7fa46ab16ff0c8b85eb101877e"></script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script>
    var container = document.getElementById('map');
    var options = {
        center: new kakao.maps.LatLng(37.56667120440735, 126.97962007985399),
        level: 3
    };

    var map = new kakao.maps.Map(container, options);

    // 마우스 이동 이벤트
    kakao.maps.event.addListener(map, 'dragend', function() {

        // 지도 중심좌표를 얻어옵니다
        var latlng = map.getCenter();

        var message = '마우스 이동 이벤트: 변경된 지도 중심좌표는 ' + latlng.getLat() + ' 이고, ';
        message += '경도는 ' + latlng.getLng() + ' 입니다';

        var resultDiv = document.getElementById('result');
        resultDiv.innerHTML = message;

        // 현재 지도 영역 구하기
        var bounds = map.getBounds();
        message = '현재 지도 영역:  ' + bounds.toString() + ' 입니다';
        var resultDiv = document.getElementById('result3');
        resultDiv.innerHTML = message;

        var rect = {ha: bounds.ha, oa: bounds.oa, pa: bounds.pa, qa: bounds.qa};

<!--        kakaoMap(rect);-->

    });

    // 지도 확대 축소 이벤트
    kakao.maps.event.addListener(map, 'zoom_changed', function() {

        // 지도의 현재 레벨을 얻어옵니다
        var level = map.getLevel();

        var message = '지도 확대 축소 이벤트: 현재 지도 레벨은 ' + level + ' 입니다';
        var resultDiv = document.getElementById('result2');
        resultDiv.innerHTML = message;


        // 지도 현재 영역 구하기
        var bounds = map.getBounds();
        message = '지도 현재 영역:  ' + bounds.toString() + ' 입니다';
        var resultDiv = document.getElementById('result3');
        resultDiv.innerHTML = message;

        var rect = {ha: bounds.ha, oa: bounds.oa, pa: bounds.pa, qa: bounds.qa};

<!--        kakaoMap(rect);-->

    });

    function kakaoMap() {
        $.ajax({
           url:'/kakaoMap',
           type:'POST',
           dataType: 'json',
<!--           data: {ha: 124, oa: 132, pa: 33, qa: 43},-->
            data: {ha: 126.960, oa: 126.970, pa: 37.563, qa: 37.564},
           success:function(data){
<!--               console.log(data);-->
           },
           error : function(e){
<!--               console.log(e);-->
           }
        });
    }

    function create_marker_test() {

        $.ajax({
           url:'/getHashtag',
           type:'GET',
           dataType: 'json',
           data: {ha: 126.960, oa: 126.970, pa: 37.563, qa: 37.564},
           success:function(data){
               console.log(data);

<!--var a = 37.56676130203928;-->
<!--var b = 126.97960873626053;-->
<!--for(var i = 1; i <= 3; i++){-->
<!--var la = a + i/1000;-->
<!--var lo = b + i/1000;-->

               $.each(data, function(index, item){
<!--var la = a + index/1000;-->
<!--var lo = b + index/1000;-->

                    var img_src = "";
                    if(item.HASHTAG_COUNT < 10) img_src = '../img/markers/mapMarker1.png';
                    if(10 <= item.HASHTAG_COUNT && item.HASHTAG_COUNT < 100) img_src = '../img/markers/mapMarker2.png';
                    if(100 <= item.HASHTAG_COUNT && item.HASHTAG_COUNT < 1000) img_src = '../img/markers/mapMarker3.png';
                    if(1000 <= item.HASHTAG_COUNT && item.HASHTAG_COUNT < 10000) img_src = '../img/markers/mapMarker4.png';
                    if(10000 <= item.HASHTAG_COUNT) img_src = '../img/markers/mapMarker5.png';


<!--                    var imageSrc = 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png', // 마커이미지의 주소입니다-->
<!--                        var imageSrc = '../img/markers/mapMarker1.png',-->
                        var imageSrc = img_src,
                        imageSize = new kakao.maps.Size(34, 39), // 마커이미지의 크기입니다
                        imageOption = {offset: new kakao.maps.Point(27, 69)}; // 마커이미지의 옵션입니다. 마커의 좌표와 일치시킬 이미지 안에서의 좌표를 설정합니다.

                    // 마커의 이미지정보를 가지고 있는 마커이미지를 생성합니다
                    console.log(item.LATITUDE);
                    console.log(item.LONGITUDE);
                    var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption),
                        markerPosition = new kakao.maps.LatLng(item.LATITUDE, item.LONGITUDE); // 마커가 표시될 위치입니다
<!--markerPosition = new kakao.maps.LatLng(data[0].LATITUDE, data[0].LONGITUDE); // 마커가 표시될 위치입니다-->
<!--markerPosition = new kakao.maps.LatLng(37.56676130203928, 126.97960873626053);-->
<!--markerPosition = new kakao.maps.LatLng(la, lo);-->

<!--markerPosition = new kakao.maps.LatLng(37.563312971786, 126.966750699562);-->

<!--if(i == 1) {markerPosition = new kakao.maps.LatLng(37.563312971786, 126.966750699562)};-->
<!--if(i == 2) {markerPosition = new kakao.maps.LatLng(37.5630974868876, 126.969546462998)};-->
<!--if(i == 3) {markerPosition = new kakao.maps.LatLng(37.563151547252, 126.969548704692)};-->

                    // 마커를 생성합니다
                    var marker = new kakao.maps.Marker({
                      position: markerPosition,
                      image: markerImage // 마커이미지 설정
                    });

                    // 마커가 지도 위에 표시되도록 설정합니다
                    marker.setMap(map);

                    // 커스텀 오버레이에 표출될 내용으로 HTML 문자열이나 document element가 가능합니다
<!--                    var hashtag_count = item.HASHTAG_COUNT;-->
var hashtag_count = item.HASHTAG_COUNT;
<!--var hashtag_count = '12';-->
<!--var hashtag_count = i;-->
                    var content =
                        '<div class="bubble">' +
                        '   <p>말풍선(위)</p>' +
                        '   <ion-icon name="heart" style="color: red;"></ion-icon>' +
                        '   <span id="sp">' + hashtag_count + '</span>' +
                        '</div>'

                    // 커스텀 오버레이가 표시될 위치입니다
                    var position = new kakao.maps.LatLng(item.LATITUDE+0.001, item.LONGITUDE);

                    // 커스텀 오버레이를 생성합니다
                    var customOverlay = new kakao.maps.CustomOverlay({
                        map: map,
                        position: position,
                        content: content,
                        yAnchor: 1
                    });
               });


<!--}-->
           },
           error : function(e){
<!--               console.log(e);-->
           }
        });

<!--        var imageSrc = 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png', // 마커이미지의 주소입니다-->
<!--            imageSize = new kakao.maps.Size(64, 69), // 마커이미지의 크기입니다-->
<!--            imageOption = {offset: new kakao.maps.Point(27, 69)}; // 마커이미지의 옵션입니다. 마커의 좌표와 일치시킬 이미지 안에서의 좌표를 설정합니다.-->

<!--        // 마커의 이미지정보를 가지고 있는 마커이미지를 생성합니다-->
<!--        var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption),-->
<!--            markerPosition = new kakao.maps.LatLng(37.56676130203928, 126.97960873626053); // 마커가 표시될 위치입니다-->

<!--        // 마커를 생성합니다-->
<!--        var marker = new kakao.maps.Marker({-->
<!--          position: markerPosition,-->
<!--          image: markerImage // 마커이미지 설정-->
<!--        });-->

<!--        // 마커가 지도 위에 표시되도록 설정합니다-->
<!--        marker.setMap(map);-->

<!--        // 커스텀 오버레이에 표출될 내용으로 HTML 문자열이나 document element가 가능합니다-->
<!--        var value = '12'-->
<!--        var content =-->
<!--            '<div class="bubble">' +-->
<!--            '   <p>말풍선(위)</p>' +-->
<!--            '   <ion-icon name="heart" style="color: red;"></ion-icon>' +-->
<!--            '   <span id="sp">' + value + '</span>' +-->
<!--            '</div>'-->

<!--        // 커스텀 오버레이가 표시될 위치입니다-->
<!--        var position = new kakao.maps.LatLng(37.56769130203928, 126.97920873626053);-->

<!--        // 커스텀 오버레이를 생성합니다-->
<!--        var customOverlay = new kakao.maps.CustomOverlay({-->
<!--            map: map,-->
<!--            position: position,-->
<!--            content: content,-->
<!--            yAnchor: 1-->
<!--        });-->
    }



    function create_marker() {
        $.ajax({
           url:'/createMarker',
           type:'GET',
<!--           dataType: 'json',-->
            data: {ha: 126.960, oa: 126.970, pa: 37.563, qa: 37.564},
           success:function(data){
               console.log(data);

               $.each(data, function(index, item){
                    var imageSrc = 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png', // 마커이미지의 주소입니다
                    imageSize = new kakao.maps.Size(64, 69), // 마커이미지의 크기입니다
                    imageOption = {offset: new kakao.maps.Point(27, 69)}; // 마커이미지의 옵션입니다. 마커의 좌표와 일치시킬 이미지 안에서의 좌표를 설정합니다.

                    // 마커의 이미지정보를 가지고 있는 마커이미지를 생성합니다
                    var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption),
                        markerPosition = new kakao.maps.LatLng(item.latitude, item.longitude); // 마커가 표시될 위치입니다

                    // 마커를 생성합니다
                    var marker = new kakao.maps.Marker({
                      position: markerPosition,
                      image: markerImage // 마커이미지 설정
                    });

                    // 마커가 지도 위에 표시되도록 설정합니다
                    marker.setMap(map);
               });
           },
           error : function(e){
<!--               console.log(e);-->
           }
        });
    }




<!--    function kakaoMap(rect) {-->
<!--        $.ajax({-->
<!--           url:'/kakaoMap',-->
<!--           type:'POST',-->
<!--           dataType: 'json',-->
<!--           data: rect,-->
<!--           success:function(data){-->
<!--               console.log(data);-->
<!--           },-->
<!--           error : function(e){-->
<!--               console.log(e);-->
<!--           }-->
<!--        });-->
<!--    }-->



create_marker_test();

</script>

<script>
    /* EXPANDER MENU */
const showMenu = (toggleId, navbarId, bodyId) => {
    const toggle = document.getElementById(toggleId),
    navbar = document.getElementById(navbarId),
    bodypadding = document.getElementById(bodyId)

    if( toggle && navbar ) {
        toggle.addEventListener('click', ()=>{
            navbar.classList.toggle('expander');

            bodypadding.classList.toggle('body-pd')
        })
    }
}

showMenu('nav-toggle', 'navbar', 'body-pd')

/* LINK ACTIVE */
const linkColor = document.querySelectorAll('.nav__link')
function colorLink() {
    linkColor.forEach(l=> l.classList.remove('active'))
    this.classList.add('active')
}
linkColor.forEach(l=> l.addEventListener('click', colorLink))

/* COLLAPSE MENU */
const linkCollapse = document.getElementsByClassName('collapse__link')
var i

for(i=0;i<linkCollapse.length;i++) {
    linkCollapse[i].addEventListener('click', function(){
        const collapseMenu = this.nextElementSibling
        collapseMenu.classList.toggle('showCollapse')

        const rotate = collapseMenu.previousElementSibling
        rotate.classList.toggle('rotate')
    });
}
</script>

<style>

.bubble
{
    position: relative;
    width: 150px;
    height: 60px;
    padding: 0px;
    background: #FFFFFF;
    -webkit-border-radius: 25px;
    -moz-border-radius: 25px;
    border-radius: 25px;
    text-align: center;
}

.bubble:after
{
    content: '';
    position: absolute;
    border-style: solid;
    border-width: 15px 15px 0;
    border-color: #FFFFFF transparent;
    display: block;
    width: 0;
    z-index: 1;
    bottom: -15px;
    left: 60px;
<!--    left: 50%;-->
}

<!--ion-icon #heart-->
<!--{-->
<!--  color: red;-->
<!--}-->

<!--.bubble span {-->
<!--    text-align: center-->
<!--}-->


<!--.room-list-empty-room{-->
<!--    position: absolute;-->
<!--    background: #5677f4;-->
<!--    color: #fff;-->
<!--    padding: 13px;-->
<!--    border-radius: 20rem;-->
<!--    top: 135px;-->
<!--    right: 15px;-->
<!--    font-size: 11pt;-->
<!--    box-shadow: 2px 2px 3px #d1d1d1;-->
<!--    z-index: -1;-->
<!--}-->
<!--.room-list-empty-room:after{-->
<!--    bottom: 100%;-->
<!--    transform: translate(-1px, 3px);-->
<!--    left: 251px;-->
<!--    border: solid transparent;-->
<!--    content: " ";-->
<!--    height: 0;-->
<!--    width: 0;-->
<!--    position: absolute;-->
<!--    pointer-events: none;-->
<!--    border-color: rgba(56, 77, 157, 0);-->
<!--    border-bottom-color: #5677f4;-->
<!--    border-width: 11px;-->
<!--    margin-left: -20px;-->
<!--}-->

<!--.balloon {-->
<!--        position: relative;-->
<!--        display: inline-block;-->
<!--    }-->

<!--    .balloon span {-->
<!--        display: inline-block;-->
<!--        padding: 10px;-->
<!--        color: #fff;-->
<!--        background: #ad1e51;-->
<!--        border-radius: 20px;-->
<!--    }-->

<!--    .balloon:after {-->
<!--        content: '';-->
<!--        position: absolute;-->
<!--        width: 0;-->
<!--        height: 0;-->
<!--        border-style: solid;-->
<!--    }-->

<!--    .balloon.top:after {-->
<!--        border-width: 15px 10px;-->
<!--        left: 50%;-->
<!--        margin-left: -10px;-->
<!--    }-->

<!--    .balloon.top:after {-->
<!--        border-color: #ad1e51 transparent transparent transparent;-->
<!--        bottom: -25px;-->
<!--    }-->

<!--.customoverlay {position:relative;bottom:85px;border-radius:6px;border: 1px solid #ccc;border-bottom:2px solid #ddd;float:left;}-->
<!--.customoverlay:nth-of-type(n) {border:0; box-shadow:0px 1px 2px #888;}-->
<!--.customoverlay a {display:block;text-decoration:none;color:#000;text-align:center;border-radius:6px;font-size:14px;font-weight:bold;overflow:hidden;background: #d95050;background: #d95050 url(https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/arrow_white.png) no-repeat right 14px center;}-->
<!--.customoverlay .title {display:block;text-align:center;background:#fff;margin-right:35px;padding:10px 15px;font-size:14px;font-weight:bold;}-->
<!--.customoverlay:after {content:'';position:absolute;margin-left:-12px;left:50%;bottom:-12px;width:22px;height:12px;background:url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/vertex_white.png')}-->

    /* GOOGLE FONTS */
@import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap");

/* VARIABLES CSS */
:root {
    --nav--width: 92px;

    /* Colores */
    --first-color: #0c5df4;
    --bg-color: #12192c;
    --sub-color: #b6cefc;
    --white-color: #fff;

    /* Fuente y tipografia */
    --body-font: 'Poppins', sans-serif;
    --normal-font-size: 1rem;
    --small-font-size: .875rem;

    /* z index */
    --z-fixed: 100;
}

/* BASE */
*, ::before, ::after {
    box-sizing: border-box;
}

body {
    position: relative;
    margin: 0;
    padding: 2rem 0 0 6.75rem;
    font-family: var(--body-font);
    font-size: var(--normal-font-size);
    transition: .5s;
}

h1 {
    margin: 0;
}

ul {
    margin: 0;
    padding: 0;
    list-style: none;
}

a {
    text-decoration: none;
}

/* l NAV */
.l-navbar {
    position: fixed;
    top: 0;
    left: 0;
    width: var(--nav--width);
    height: 100vh;
    background-color: var(--bg-color);
    color: var(--white-color);
    padding: 1.5rem 1.5rem 2rem;
    transition: .5s;
    z-index: var(--z-fixed);
}

/* NAV */
.nav {
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    overflow: hidden;
}

.nav__brand {
    display: grid;
    grid-template-columns: max-content max-content;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.nav__toggle {
    font-size: 1.25rem;
    padding: .75rem;
    cursor: pointer;
}

.nav__logo {
    color: var(--white-color);
    font-weight: 600;
}

.nav__link {
    display: grid;
    grid-template-columns: max-content max-content;
    align-items: center;
    column-gap: .75rem;
    padding: .75rem;
    color: var(--white-color);
    border-radius: .5rem;
    margin-bottom: 1rem;
    transition: .3s;
    cursor: pointer;
}

.nav__link:hover {
    background-color: var(--first-color);
}

.nav__icon {
    font-size: 1.25rem;
}

.nav_name {
    font-size: var(--small-font-size);
}

/* Expander menu */
.expander {
    width: calc(var(--nav--width) + 9.25rem);
}

/* Add padding body*/
.body-pd {
    padding: 2rem 0 0 16rem;
}

/* Active links menu */
.active {
    background-color: var(--first-color);
}

/* COLLAPSE */
.collapse {
    grid-template-columns: 20px max-content 1fr;
}

.collapse__link {
    justify-self: flex-end;
    transition: .5;
}

.collapse__menu {
    display: none;
    padding: .75rem 2.25rem;
}

.collapse__sublink {
    color: var(--sub-color);
    font-size: var(--small-font-size);
}

.collapse__sublink:hover {
    color: var(--white-color);
}

/* Show collapse */
.showCollapse {
    display: block;
}

/* Rotate icon */
.rotate {
    transform: rotate(180deg);
    transition: .5s;
}
</style>
</html>